# **Product Requirement Document (PRD): Factor-FinMem**

## **1. 프로젝트 개요 (Project Overview)**

### **1.1. 프로젝트 명**
**Factor-FinMem**: LLM 기반 매크로 분석 및 자율 학습형 팩터 자산 배분 시스템

### **1.2. 목적 (Objective)**
* **비정형 데이터의 지식화**: 키움증권의 시황/전망 리포트와 같은 비정형 텍스트 데이터를 금융 전문가 페르소나를 가진 에이전트가 해석하여 정량적인 투자 견해(View)로 변환한다.
* **자율 진화형 메모리 시스템**: 과거 예측의 정확도를 기반으로 지식의 신뢰도를 스스로 조정하고, 실패 사례에 대한 회고(Reflection)를 통해 에이전트의 판단력을 지속적으로 향상시킨다.
* **지능형 포트폴리오 최적화**: 에이전트 그룹의 집단 지성(Committee View)과 시장의 균형을 결합하여, 리스크 대비 수익을 극대화하는 최적의 팩터 배분 안을 도출한다.

---

## **2. 데이터 아키텍처 요구사항 (Logical Data Architecture)**

시스템은 데이터의 생애주기와 활용 목적에 따라 세 가지 논리적 계층으로 관리되어야 한다.

### **Tier 1: Raw Data Lake**
* **목적**: 원본 데이터의 영구 보존 및 무결성 보장.
* **요구사항**: 수집된 리포트의 원본 텍스트와 발행일 등 기초 메타데이터를 가공 없이 보존하며, 추후 재가공 시 신뢰할 수 있는 단일 진실 공급원(Single Source of Truth) 역할을 수행해야 한다.

### **Tier 2: Memory Warehouse**
* **목적**: 에이전트의 인지, 검색 및 지식 축적을 위한 지능형 저장소.
* **요구사항**: 
    - 텍스트의 의미론적 유사성 검색이 가능해야 함.
    - **계층적 메모리 구조 (Layered Long-term Memory)** 구현:
        1. **Shallow Layer**: 일일 시황 및 뉴스 (`daily`) - High Decay (단기 기억)
        2. **Intermediate Layer**: 주간/월간 리포트 및 전망 (`weekly`, `monthly`) - Medium Decay (중기 기억)
        3. **Deep Layer**: 에이전트의 회고(Reflection) 및 핵심 금융 지식 - Low Decay (장기 기억)
    - **메타데이터 필수 포함**: 모든 청크는 `date` (시점), `importance` (중요도), `reliability` (신뢰도) 정보를 포함하여 **Recency-weighted Retrieval**을 지원해야 함.
    - FinMem의 핵심인 계층적 메모리 구조를 통해 정보의 중요도와 신뢰도를 관리할 수 있어야 함.

### **Tier 3: Structured Mart**
* **목적**: 정형 데이터 관리 및 성과 분석.
* **요구사항**: 팩터 수익률과 같은 시장 데이터, 에이전트의 페르소나 설정, 과거 예측 기록 및 포트폴리오 성과 지표를 체계적으로 관리하여 분석 및 보고가 용이해야 한다.

---

## **3. 주요 프로세스 요구사항 (Functional Workflows)**

### **3.1. 지식 인입 및 가공 (Ingestion & Processing)**
* **자동 수집**: 외부 리포트 파일을 감지하여 시스템으로 인입해야 한다.
* **텍스트 정제**: 비정형 파일로부터 유의미한 텍스트 정보를 추출해야 한다.
* **지식 요약**: 금융 팩터 분석 관점에서 핵심 내용을 요약하여 메모리 시스템에 적재해야 한다.

### **3.2. 에이전트 추론 및 의사결정 (Intelligence & Decision)**
* **위원회 시스템**: 특정 팩터에 대해 다수의 에이전트가 독립적으로 판단하고 이를 종합하는 위원회 구조를 통해 예측의 불확실성을 측정해야 한다.
* **맥락 구성 (Context Engineering)**: 에이전트가 판단 시점에 가장 신뢰도 높고 관련성 있는 기억만을 선별하여 참조할 수 있도록 지원해야 한다.
* **예측 생성**: 시장 리포트를 바탕으로 팩터 수익률의 방향성과 그에 대한 확신도를 정량적으로 산출해야 한다.

### **3.3. 학습 및 최적화 (Learning & Optimization)**
* **포트폴리오 구성**: 에이전트의 견해와 시장 데이터를 결합하여 최적의 자산 배분 비중을 계산해야 한다.
* **성과 피드백**: 실제 시장 결과와 예측을 비교하여 에이전트의 판단을 평가해야 한다.
* **메모리 진화**: 평가 결과에 따라 유용한 정보는 상위 계층으로 승격시키고, 오답에 대해서는 회고 데이터를 생성하여 지식 베이스를 갱신해야 한다.

---

## **4. 비기능적 요구사항 (Non-Functional Requirements)**

* **데이터 무결성 및 편향 방지**: 백테스팅 시 미래 데이터를 참조하는 Look-ahead bias가 발생하지 않도록 엄격한 시점 제어가 이루어져야 한다.
* **추적 가능성 (Traceability)**: 에이전트가 내린 모든 판단은 어떤 원본 데이터와 어떤 논리에 근거했는지 추적 가능해야 한다.
* **모듈화**: RAG 전략, 포트폴리오 최적화 로직 등은 필요에 따라 교체 가능한 구조여야 한다.

---

## **5. 기대 효과 (Expected Outcomes)**

* **정성 데이터의 계량화**: 전문가의 통찰력이 담긴 리포트를 정량적 모델의 입력값으로 활용함으로써 투자 모델의 알파(Alpha)를 창출한다.
* **지속적 성능 개선**: 시간이 흐를수록 에이전트의 지식 베이스가 정교해지며, 시장 변화에 유연하게 대응하는 자율 학습형 시스템을 구축한다.
